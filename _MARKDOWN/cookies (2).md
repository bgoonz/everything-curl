<a href="../index.html" class="link-a079aa82--primary-53a25e66--logoLink-10d08504"></a>





<a href="../index.html" class="link-a079aa82--primary-53a25e66--logoLink-10d08504"></a>





<a href="../index.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Introduction</span></a>

<a href="../how-to-read.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">How to read this book</span></a>





<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">How to HTTP with curl</span>

<a href="basics.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Protocol basics</span></a>

<a href="response.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Responses</span></a>

<a href="auth.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Authentication</span></a>

<a href="ranges.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Ranges</span></a>

<a href="versions.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">HTTP versions</span></a>

<a href="https.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">HTTPS</span></a>

<a href="post.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">HTTP POST</span></a>

<a href="multipart.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Multipart formposts</span></a>

<a href="postvspost.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">-d vs -F</span></a>

<a href="redirects.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Redirects</span></a>

<a href="requests.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Modify the HTTP request</span></a>

<a href="put.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">HTTP PUT</span></a>

<a href="cookies.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca--navButtonOpened-6a88552e"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Cookies</span></a>

<a href="http2.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">HTTP/2</span></a>

<a href="altsvc.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Alternative Services</span></a>

<a href="http3.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">HTTP/3</span></a>

<a href="cheatsheet.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">HTTP cheat sheet</span></a>

<a href="browserlike.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Scripting browser-like tasks</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">libcurl basics</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">HTTP with libcurl</span>

<a href="../bindings.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Bindings</span></a>

<a href="../internals.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">libcurl internals</span></a>

<a href="../bookindex.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"></span></a>





# <span class="text-4505230f--DisplayH900-bfb998fa--textContentFamily-49a318e1">Cookies</span>

<span class="text-4505230f--UIH300-2063425d--textUIFamily-5ebd8e40--text-8ee2c8b2"></span>

<span class="text-4505230f--UIH300-2063425d--textUIFamily-5ebd8e40--text-8ee2c8b2"></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="2a85639aa89c47269c3c69075221440a"><span data-offset-key="2a85639aa89c47269c3c69075221440a:0">HTTP cookies are key/value pairs that a client stores on the behalf of a server. They are sent back in subsequent requests to allow clients to keep state between requests. Remember that the HTTP protocol itself has no state but instead the client has to resend all data in subsequent requests that it wants the server to be aware of.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="f4bc2bcbe9b147c688b8f2821f3cdc8a"><span data-offset-key="f4bc2bcbe9b147c688b8f2821f3cdc8a:0">Cookies are set by the server with the </span><span data-offset-key="f4bc2bcbe9b147c688b8f2821f3cdc8a:1">`Set-Cookie:`</span><span data-offset-key="f4bc2bcbe9b147c688b8f2821f3cdc8a:2"> header and with each cookie the server sends a bunch of extra properties that need to match for the client to send the cookie back. Like domain name and path and perhaps most important for how long the cookie should live on.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="846d7abea5224e08b22a2d7a0d9635dd"><span data-offset-key="846d7abea5224e08b22a2d7a0d9635dd:0">The expiry of a cookie is either set to a fixed time in the future (or to live a number of seconds) or it gets no expiry at all. A cookie without an expire time is called a "session cookie" and is meant to live during the "session" but not longer. A session in this aspect is typically thought to be the life time of the browser used to view a site. When you close the browser, you end your session. Doing HTTP operations with a command-line client that supports cookies begs the question of when a session really endsâ€¦</span></span></span>

<span class="text-4505230f--HeadingH700-04e1a2a3--textContentFamily-49a318e1"><span data-key="fe290c5b5e1e420c9bd52df02d059c76"><span data-offset-key="fe290c5b5e1e420c9bd52df02d059c76:0">Cookie engine</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="b600a54466e7446fb8b3206fe6099812"><span data-offset-key="b600a54466e7446fb8b3206fe6099812:0">The general concept of curl only doing the bare minimum unless you tell it differently makes it not acknowledge cookies by default. You need to switch on "the cookie engine" to make curl keep track of cookies it receives and then subsequently send them out on requests that have matching cookies.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="e5e7c0b093a34577871467bf5d0fd2d2"><span data-offset-key="e5e7c0b093a34577871467bf5d0fd2d2:0">You enable the cookie engine by asking curl to read or write cookies. If you tell curl to read cookies from a non-existing file, you will only switch on the engine but start off with an empty internal cookie store:</span></span></span>

    curl -b non-existing http://example.com

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="e890dba0149045fabaf20599b839276c"><span data-offset-key="e890dba0149045fabaf20599b839276c:0">Just switching on the cookie engine, getting a single resource and then quitting would be pointless as curl would have no chance to actually send any cookies it received. Assuming the site in this example would set cookies and then do a redirect we would do:</span></span></span>

    curl -L -b non-existing http://example.com

<span class="text-4505230f--HeadingH700-04e1a2a3--textContentFamily-49a318e1"><span data-key="a5aa83b6b8db45b69dfd1793e5827043"><span data-offset-key="a5aa83b6b8db45b69dfd1793e5827043:0">Reading cookies from file</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="f87e1baf0bd7490aa0f4849a31392cf7"><span data-offset-key="f87e1baf0bd7490aa0f4849a31392cf7:0">Starting off with a blank cookie store may not be desirable. Why not start off with cookies you stored in a previous fetch or that you otherwise acquired? The file format curl uses for cookies is called the Netscape cookie format because it was once the file format used by browsers and then you could easily tell curl to use the browser's cookies!</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="3ca7b0835fe54992941ca9ba9155b88a"><span data-offset-key="3ca7b0835fe54992941ca9ba9155b88a:0">As a convenience, curl also supports a cookie file being a set of HTTP headers that set cookies. It's an inferior format but may be the only thing you have.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="a29758a9b6a24decbfc78733bdbd1ecd"><span data-offset-key="a29758a9b6a24decbfc78733bdbd1ecd:0">Tell curl which file to read the initial cookies from:</span></span></span>

    curl -L -b cookies.txt http://example.com

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="1ad77400327e495791b72eb030a60a45"><span data-offset-key="1ad77400327e495791b72eb030a60a45:0">Remember that this only </span><span data-offset-key="1ad77400327e495791b72eb030a60a45:1">_reads_</span><span data-offset-key="1ad77400327e495791b72eb030a60a45:2"> from the file. If the server would update the cookies in its response, curl would update that cookie in its in-memory store but then eventually throw them all away when it exits and a subsequent invocation of the same input file would use the original cookie contents again.</span></span></span>

<span class="text-4505230f--HeadingH700-04e1a2a3--textContentFamily-49a318e1"><span data-key="89d4aff8bee84a4695be78eb01b0db6b"><span data-offset-key="89d4aff8bee84a4695be78eb01b0db6b:0">Writing cookies to file</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="62298c6501f04909bd421e7f59f74724"><span data-offset-key="62298c6501f04909bd421e7f59f74724:0">The place where cookies are stored is sometimes referred to as the "cookie jar". When you enable the cookie engine in curl and it has received cookies, you can instruct curl to write down all its known cookies to a file, the cookie jar, before it exits. It is important to remember that curl only updates the output cookie jar on exit and not during its lifetime, no matter how long the handling of the given input takes.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="5c60aa60ca4448658a386e180aeac1d0"><span data-offset-key="5c60aa60ca4448658a386e180aeac1d0:0">You point out the cookie jar output with </span><span data-offset-key="5c60aa60ca4448658a386e180aeac1d0:1">`-c`</span><span data-offset-key="5c60aa60ca4448658a386e180aeac1d0:2">:</span></span></span>

    curl -c cookie-jar.txt http://example.com

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="25885f98169b461eb45a75d93f659268"><span data-offset-key="25885f98169b461eb45a75d93f659268:0">`-c`</span><span data-offset-key="25885f98169b461eb45a75d93f659268:1"> is the instruction to </span><span data-offset-key="25885f98169b461eb45a75d93f659268:2">_write_</span><span data-offset-key="25885f98169b461eb45a75d93f659268:3"> cookies to a file, </span><span data-offset-key="25885f98169b461eb45a75d93f659268:4">`-b`</span><span data-offset-key="25885f98169b461eb45a75d93f659268:5"> is the instruction to </span><span data-offset-key="25885f98169b461eb45a75d93f659268:6">_read_</span><span data-offset-key="25885f98169b461eb45a75d93f659268:7"> cookies from a file. Oftentimes you want both.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="02888368ceae4c0a8219f828d769ca05"><span data-offset-key="02888368ceae4c0a8219f828d769ca05:0">When curl writes cookies to this file, it will save all known cookies including those that are session cookies (without a given lifetime). curl itself has no notion of a session and it does not know when a session ends so it will not flush session cookies unless you tell it to.</span></span></span>

<span class="text-4505230f--HeadingH700-04e1a2a3--textContentFamily-49a318e1"><span data-key="e60de94942924a249b3193d5e1334708"><span data-offset-key="e60de94942924a249b3193d5e1334708:0">New cookie session</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="369c0f3ce3e6456c8820479a329394eb"><span data-offset-key="369c0f3ce3e6456c8820479a329394eb:0">Instead of telling curl when a session ends, curl features an option that lets the user decide when a new session </span><span data-offset-key="369c0f3ce3e6456c8820479a329394eb:1">_begins_</span><span data-offset-key="369c0f3ce3e6456c8820479a329394eb:2">.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="d6125fc657b844098c6986867f3d0172"><span data-offset-key="d6125fc657b844098c6986867f3d0172:0">A new cookie session means that all the old session cookies will be thrown away. It is the equivalent of closing a browser and starting it up again.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="efbf653f37b644bb83622d108a49bb95"><span data-offset-key="efbf653f37b644bb83622d108a49bb95:0">Tell curl a new cookie session starts by using </span><span data-offset-key="efbf653f37b644bb83622d108a49bb95:1">`-j, --junk-session-cookies`</span><span data-offset-key="efbf653f37b644bb83622d108a49bb95:2">:</span></span></span>

    curl -j -b cookies.txt http://example.com/

<a href="put.html" class="reset-3c756112--card-6570f064--whiteCard-fff091a4--cardPrevious-56a5e674"></a>

<span class="text-4505230f--TextH200-a3425406--textContentFamily-49a318e1">Previous</span>

<span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1">HTTP PUT</span>

<a href="http2.html" class="reset-3c756112--card-6570f064--whiteCard-fff091a4--cardNext-19241c42"></a>


<span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1">HTTP/2</span>



<span class="text-4505230f--TextH200-a3425406--textContentFamily-49a318e1">Last updated 12 months ago</span>



<span class="text-4505230f--InfoH100-1e92e1d1--textContentFamily-49a318e1">Contents</span>

<a href="cookies.html#cookie-engine" class="reset-3c756112--menuItem-aa02f6ec--menuItemLight-757d5235--menuItemInline-173bdf97--pageTocItem-f4427024"></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1"><span class="text-4505230f--UIH200-50ead35f--textContentFamily-49a318e1">Cookie engine</span></span>

<a href="cookies.html#reading-cookies-from-file" class="reset-3c756112--menuItem-aa02f6ec--menuItemLight-757d5235--menuItemInline-173bdf97--pageTocItem-f4427024"></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1"><span class="text-4505230f--UIH200-50ead35f--textContentFamily-49a318e1">Reading cookies from file</span></span>

<a href="cookies.html#writing-cookies-to-file" class="reset-3c756112--menuItem-aa02f6ec--menuItemLight-757d5235--menuItemInline-173bdf97--pageTocItem-f4427024"></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1"><span class="text-4505230f--UIH200-50ead35f--textContentFamily-49a318e1">Writing cookies to file</span></span>

<a href="cookies.html#new-cookie-session" class="reset-3c756112--menuItem-aa02f6ec--menuItemLight-757d5235--menuItemInline-173bdf97--pageTocItem-f4427024"></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1"><span class="text-4505230f--UIH200-50ead35f--textContentFamily-49a318e1">New cookie session</span></span>
